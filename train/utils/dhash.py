import numpy as np
from PIL import Image
from PIL.Image import Image as _Image

mask = np.array([
    [33, 82, 34, 123, 126, 169, 64, 47, 69, 149, 248, 142, 211, 157, 145, 16, 41, 26, 21, 195, 80, 247, 184, 191, 53, 93, 180, 9, 24, 54, 183, 101, 10, 44, 45, 216, 90, 80, 189, 8, 232, 46, 23, 192, 86, 90, 160, 21, 95, 159, 8, 95, 236, 173, 208, 189, 145, 226, 160, 224, 150, 112, 71, 132],
    [26, 5, 142, 103, 98, 225, 211, 197, 118, 66, 177, 17, 161, 9, 108, 219, 92, 3, 46, 18, 116, 121, 29, 197, 89, 153, 193, 48, 170, 90, 16, 7, 38, 225, 219, 150, 11, 77, 206, 36, 237, 231, 10, 253, 166, 92, 31, 139, 8, 109, 22, 218, 99, 7, 54, 242, 187, 78, 247, 165, 193, 15, 188, 46],
    [240, 235, 51, 90, 126, 65, 10, 31, 65, 4, 125, 188, 180, 183, 246, 70, 35, 175, 23, 172, 74, 249, 99, 136, 193, 106, 142, 64, 173, 240, 220, 240, 43, 134, 206, 112, 118, 12, 196, 35, 182, 116, 208, 204, 148, 63, 67, 236, 18, 23, 3, 221, 89, 148, 247, 71, 117, 38, 88, 178, 19, 78, 41, 190],
    [35, 243, 89, 197, 183, 86, 33, 221, 3, 134, 20, 232, 158, 228, 204, 231, 95, 179, 200, 116, 142, 20, 77, 141, 21, 150, 223, 213, 100, 140, 96, 97, 159, 217, 51, 11, 43, 189, 238, 125, 147, 126, 197, 154, 64, 236, 102, 112, 220, 114, 118, 216, 197, 25, 212, 156, 112, 168, 174, 40, 95, 75, 49, 7],
    [155, 191, 11, 244, 206, 19, 205, 83, 141, 210, 99, 251, 231, 239, 246, 198, 136, 80, 33, 151, 79, 194, 98, 19, 80, 229, 85, 134, 212, 170, 18, 71, 21, 234, 42, 132, 79, 216, 131, 23, 207, 233, 191, 150, 72, 9, 133, 204, 48, 182, 146, 182, 184, 139, 87, 99, 181, 20, 32, 105, 35, 67, 201, 251],
    [76, 91, 210, 231, 119, 4, 35, 187, 116, 7, 24, 168, 230, 137, 43, 218, 78, 237, 182, 210, 184, 227, 181, 143, 106, 33, 156, 57, 3, 95, 250, 185, 199, 119, 193, 69, 158, 44, 86, 97, 76, 124, 199, 244, 175, 113, 23, 119, 240, 136, 236, 231, 193, 42, 163, 29, 129, 94, 67, 178, 74, 12, 219, 77],
    [55, 27, 185, 244, 179, 76, 241, 122, 232, 76, 129, 49, 137, 51, 3, 228, 150, 214, 201, 168, 232, 242, 84, 215, 6, 177, 120, 132, 196, 7, 91, 243, 106, 81, 27, 239, 233, 199, 179, 44, 4, 183, 0, 32, 23, 33, 233, 90, 146, 251, 84, 108, 247, 249, 104, 123, 247, 8, 121, 127, 176, 99, 209, 132],
    [138, 29, 73, 47, 79, 57, 165, 204, 150, 28, 237, 207, 240, 228, 61, 117, 70, 58, 64, 102, 109, 140, 245, 146, 127, 154, 189, 234, 61, 171, 252, 1, 68, 93, 204, 82, 253, 252, 237, 117, 117, 251, 57, 74, 242, 16, 92, 124, 49, 103, 1, 240, 89, 232, 250, 8, 163, 215, 213, 190, 86, 231, 150, 203],
    [103, 212, 55, 145, 157, 49, 78, 249, 13, 95, 159, 14, 179, 156, 42, 209, 36, 188, 202, 136, 80, 205, 183, 39, 81, 136, 97, 61, 52, 78, 109, 206, 25, 12, 1, 184, 209, 86, 197, 194, 75, 5, 95, 196, 193, 96, 248, 120, 217, 98, 69, 144, 101, 193, 236, 63, 33, 242, 250, 93, 118, 36, 105, 57],
    [249, 74, 2, 204, 56, 210, 165, 175, 198, 174, 216, 155, 116, 235, 1, 85, 119, 24, 38, 12, 230, 19, 129, 13, 16, 151, 212, 208, 56, 241, 248, 39, 210, 254, 148, 156, 127, 185, 14, 30, 214, 203, 232, 42, 116, 228, 230, 148, 132, 127, 52, 23, 43, 165, 19, 56, 77, 61, 136, 38, 141, 118, 227, 87],
    [25, 8, 111, 189, 248, 86, 243, 209, 38, 9, 73, 175, 0, 234, 63, 151, 101, 87, 45, 190, 69, 151, 83, 147, 136, 182, 40, 230, 113, 146, 204, 126, 37, 234, 234, 153, 17, 74, 157, 18, 82, 254, 8, 72, 171, 247, 14, 117, 228, 58, 246, 86, 211, 138, 29, 39, 168, 204, 167, 43, 94, 158, 3, 253],
    [145, 26, 163, 153, 38, 78, 3, 232, 248, 170, 178, 82, 4, 165, 11, 14, 33, 219, 227, 153, 36, 159, 180, 207, 216, 201, 138, 34, 107, 115, 44, 97, 188, 102, 17, 59, 71, 109, 2, 213, 160, 49, 234, 103, 220, 108, 216, 178, 86, 195, 85, 57, 83, 70, 116, 87, 86, 140, 120, 56, 76, 25, 144, 154],
    [233, 20, 201, 48, 235, 48, 4, 183, 29, 10, 3, 182, 94, 138, 236, 118, 79, 250, 158, 25, 227, 131, 103, 108, 65, 153, 207, 223, 221, 96, 68, 242, 94, 30, 53, 2, 16, 111, 98, 187, 178, 233, 130, 104, 49, 239, 183, 241, 84, 151, 19, 173, 233, 46, 132, 59, 231, 108, 245, 227, 158, 13, 182, 185],
    [145, 24, 31, 114, 225, 65, 84, 170, 174, 33, 158, 45, 149, 102, 56, 129, 131, 126, 189, 143, 9, 241, 126, 42, 53, 137, 238, 215, 101, 108, 60, 37, 159, 111, 57, 237, 26, 26, 210, 18, 59, 69, 104, 15, 81, 116, 88, 126, 250, 41, 203, 249, 68, 84, 176, 105, 79, 126, 138, 192, 180, 253, 58, 108],
    [49, 61, 224, 43, 190, 107, 161, 186, 189, 253, 237, 180, 170, 141, 212, 247, 151, 114, 188, 4, 116, 8, 154, 44, 125, 83, 69, 127, 128, 181, 96, 156, 206, 51, 33, 122, 108, 34, 154, 17, 107, 3, 170, 100, 58, 151, 140, 165, 179, 207, 210, 131, 9, 84, 71, 83, 174, 205, 133, 64, 228, 231, 132, 174],
    [87, 137, 76, 190, 246, 157, 125, 90, 33, 201, 88, 199, 165, 147, 51, 219, 223, 214, 24, 77, 76, 233, 32, 215, 57, 34, 128, 106, 147, 64, 14, 72, 39, 63, 145, 129, 172, 190, 51, 30, 147, 35, 152, 111, 118, 25, 198, 132, 32, 221, 107, 48, 237, 210, 251, 57, 235, 72, 58, 55, 19, 207, 139, 31],
    [117, 221, 20, 41, 85, 9, 195, 14, 23, 119, 148, 19, 43, 65, 199, 115, 187, 59, 15, 200, 107, 97, 154, 96, 145, 45, 4, 31, 50, 108, 31, 92, 204, 192, 82, 84, 162, 194, 105, 86, 154, 189, 78, 26, 44, 168, 117, 201, 173, 174, 216, 59, 132, 16, 209, 99, 154, 168, 127, 166, 54, 153, 150, 18],
    [108, 101, 171, 192, 121, 54, 89, 240, 235, 205, 156, 180, 51, 110, 51, 200, 28, 93, 232, 211, 246, 38, 195, 161, 173, 137, 232, 236, 93, 89, 201, 129, 86, 223, 132, 250, 181, 121, 137, 150, 156, 68, 202, 132, 51, 78, 175, 173, 196, 149, 48, 75, 120, 151, 228, 123, 128, 129, 118, 143, 171, 8, 86, 101],
    [148, 237, 51, 127, 119, 238, 190, 70, 26, 153, 186, 51, 189, 19, 110, 32, 238, 202, 225, 20, 221, 45, 158, 97, 57, 132, 40, 209, 152, 161, 26, 32, 127, 112, 52, 208, 168, 115, 32, 75, 244, 226, 149, 185, 231, 86, 199, 39, 212, 88, 41, 30, 254, 140, 24, 20, 224, 247, 181, 78, 8, 158, 8, 172],
    [222, 82, 91, 234, 59, 78, 56, 87, 69, 192, 92, 37, 208, 210, 101, 9, 196, 92, 132, 100, 131, 127, 197, 161, 169, 17, 210, 194, 168, 6, 144, 69, 7, 109, 226, 115, 23, 107, 78, 229, 211, 58, 39, 161, 199, 62, 250, 153, 32, 206, 9, 130, 194, 69, 141, 82, 146, 80, 37, 171, 60, 192, 185, 254],
    [153, 212, 69, 141, 218, 94, 61, 156, 35, 239, 189, 176, 238, 241, 251, 167, 198, 77, 49, 34, 194, 247, 199, 175, 33, 201, 5, 8, 45, 38, 103, 169, 114, 246, 223, 245, 82, 132, 191, 69, 149, 157, 7, 232, 188, 127, 246, 125, 176, 144, 27, 76, 251, 132, 67, 153, 203, 106, 96, 101, 231, 165, 202, 190],
    [6, 187, 232, 49, 181, 11, 63, 97, 25, 83, 104, 141, 161, 86, 32, 231, 254, 57, 189, 143, 136, 158, 13, 195, 68, 37, 85, 2, 162, 16, 164, 76, 24, 172, 14, 240, 112, 224, 195, 79, 28, 219, 188, 70, 199, 253, 91, 73, 30, 113, 71, 31, 128, 0, 33, 115, 130, 84, 108, 248, 240, 26, 44, 124],
    [145, 24, 110, 47, 104, 237, 180, 112, 5, 41, 34, 232, 46, 84, 130, 178, 234, 24, 129, 62, 245, 8, 25, 8, 82, 0, 133, 182, 237, 169, 223, 232, 149, 154, 45, 182, 123, 195, 130, 205, 108, 254, 109, 89, 155, 221, 229, 126, 161, 157, 181, 121, 22, 105, 31, 0, 57, 46, 150, 90, 148, 241, 107, 110],
    [174, 166, 56, 103, 246, 185, 26, 70, 178, 9, 221, 133, 213, 220, 198, 119, 76, 98, 196, 64, 43, 21, 2, 254, 224, 65, 157, 54, 102, 183, 102, 201, 11, 111, 147, 250, 24, 250, 89, 71, 208, 166, 138, 68, 244, 126, 50, 240, 185, 110, 49, 62, 18, 87, 146, 38, 227, 205, 160, 248, 123, 105, 159, 220],
    [92, 58, 74, 173, 32, 64, 58, 111, 66, 18, 186, 240, 122, 174, 122, 168, 186, 207, 31, 133, 122, 119, 108, 115, 9, 59, 93, 100, 171, 115, 124, 100, 16, 93, 95, 195, 23, 238, 223, 220, 28, 232, 79, 39, 240, 200, 120, 56, 190, 36, 6, 197, 9, 55, 106, 172, 120, 195, 161, 233, 71, 149, 33, 0],
    [30, 188, 240, 53, 15, 220, 107, 222, 136, 210, 142, 6, 216, 122, 162, 139, 231, 90, 118, 115, 60, 246, 226, 252, 139, 67, 51, 18, 50, 114, 246, 28, 176, 150, 75, 191, 20, 32, 185, 97, 124, 26, 13, 250, 32, 145, 153, 70, 228, 198, 157, 19, 61, 227, 97, 158, 156, 79, 16, 145, 231, 85, 250, 241],
    [84, 149, 222, 25, 121, 185, 231, 136, 26, 97, 106, 199, 144, 68, 225, 34, 48, 169, 100, 183, 180, 174, 39, 34, 238, 72, 46, 92, 223, 166, 172, 185, 246, 228, 207, 223, 103, 142, 212, 215, 233, 242, 198, 174, 48, 44, 22, 63, 53, 95, 218, 219, 230, 174, 64, 176, 75, 28, 178, 67, 164, 108, 143, 60],
    [152, 182, 30, 31, 128, 229, 170, 113, 81, 204, 55, 225, 73, 13, 10, 165, 124, 244, 96, 249, 31, 141, 63, 100, 54, 219, 52, 20, 84, 19, 232, 86, 47, 241, 178, 134, 57, 174, 190, 189, 239, 110, 98, 220, 242, 42, 46, 218, 148, 190, 124, 215, 34, 79, 140, 136, 25, 178, 230, 120, 7, 171, 189, 14],
    [25, 186, 24, 204, 23, 39, 46, 142, 2, 216, 72, 68, 41, 246, 234, 181, 108, 94, 23, 202, 227, 48, 2, 72, 232, 245, 106, 225, 219, 249, 8, 123, 63, 197, 125, 26, 240, 34, 38, 83, 28, 39, 141, 42, 236, 13, 241, 67, 27, 7, 225, 192, 108, 0, 12, 130, 162, 115, 189, 62, 160, 82, 111, 114],
    [90, 45, 30, 197, 236, 171, 248, 12, 176, 236, 52, 13, 104, 105, 82, 14, 222, 76, 65, 27, 42, 3, 107, 34, 81, 130, 105, 2, 61, 10, 220, 110, 209, 4, 175, 132, 97, 34, 186, 141, 98, 233, 248, 145, 8, 247, 208, 24, 32, 105, 51, 27, 211, 117, 216, 203, 117, 28, 34, 209, 120, 101, 233, 232],
    [5, 144, 7, 204, 157, 172, 14, 73, 13, 209, 235, 33, 203, 164, 252, 91, 62, 76, 203, 175, 229, 170, 6, 94, 174, 107, 4, 58, 17, 218, 217, 81, 147, 107, 171, 119, 113, 170, 30, 59, 226, 235, 54, 8, 247, 134, 194, 36, 62, 23, 172, 139, 92, 54, 46, 81, 141, 56, 136, 232, 177, 231, 74, 20],
    [223, 144, 112, 131, 242, 182, 168, 251, 117, 16, 162, 202, 6, 134, 48, 211, 142, 26, 4, 81, 62, 120, 101, 214, 149, 163, 182, 119, 230, 227, 80, 249, 119, 60, 215, 142, 211, 82, 113, 127, 204, 203, 118, 68, 14, 19, 88, 45, 88, 96, 44, 121, 184, 250, 31, 13, 166, 228, 38, 116, 205, 135, 168, 196],
    [180, 29, 187, 145, 128, 190, 107, 12, 131, 176, 202, 185, 229, 239, 154, 188, 234, 82, 9, 166, 160, 234, 142, 73, 104, 218, 117, 213, 231, 82, 207, 177, 57, 198, 166, 132, 114, 97, 74, 148, 160, 245, 139, 139, 230, 142, 23, 89, 6, 211, 7, 248, 58, 71, 61, 49, 25, 102, 169, 39, 126, 62, 204, 184],
    [222, 21, 68, 67, 136, 200, 146, 177, 132, 78, 193, 169, 51, 67, 188, 99, 24, 74, 75, 43, 173, 45, 203, 158, 3, 47, 200, 119, 164, 88, 157, 93, 235, 231, 184, 156, 54, 118, 142, 207, 44, 242, 156, 196, 245, 28, 47, 123, 233, 249, 196, 197, 178, 250, 55, 242, 31, 127, 65, 138, 45, 252, 109, 88],
    [51, 236, 29, 247, 224, 112, 103, 183, 185, 209, 246, 45, 179, 246, 125, 116, 184, 224, 250, 232, 139, 96, 40, 125, 2, 13, 198, 127, 55, 246, 23, 131, 220, 12, 177, 48, 127, 40, 111, 67, 181, 140, 62, 234, 176, 118, 229, 250, 223, 73, 231, 208, 34, 154, 130, 93, 198, 201, 84, 195, 75, 254, 163, 235],
    [55, 32, 89, 185, 251, 195, 51, 206, 53, 225, 248, 2, 201, 217, 63, 135, 193, 13, 197, 25, 123, 40, 244, 118, 226, 214, 23, 9, 134, 37, 31, 246, 73, 249, 65, 175, 128, 141, 127, 60, 197, 73, 37, 114, 164, 224, 92, 244, 203, 166, 90, 71, 35, 211, 64, 2, 131, 113, 146, 153, 174, 38, 181, 191],
    [118, 165, 39, 29, 110, 143, 111, 192, 100, 175, 59, 248, 53, 184, 229, 174, 14, 182, 217, 58, 232, 174, 188, 19, 180, 32, 13, 238, 172, 201, 193, 182, 101, 163, 153, 71, 111, 16, 103, 98, 128, 202, 104, 120, 98, 185, 194, 116, 235, 165, 155, 69, 28, 113, 211, 48, 225, 227, 130, 162, 98, 49, 17, 110],
    [184, 187, 72, 8, 78, 96, 249, 92, 142, 177, 18, 102, 93, 41, 85, 125, 0, 86, 154, 218, 8, 23, 205, 87, 196, 5, 79, 231, 46, 196, 219, 74, 109, 213, 43, 29, 241, 165, 235, 104, 99, 75, 7, 212, 108, 151, 195, 197, 237, 51, 236, 93, 150, 105, 246, 253, 245, 211, 24, 82, 1, 76, 103, 241],
    [132, 20, 229, 13, 180, 254, 156, 239, 139, 196, 11, 232, 167, 23, 201, 232, 127, 55, 194, 103, 249, 181, 5, 80, 221, 237, 61, 226, 197, 117, 198, 138, 192, 61, 217, 201, 96, 137, 146, 11, 155, 101, 192, 115, 104, 113, 180, 148, 72, 166, 213, 175, 146, 194, 211, 175, 163, 226, 123, 137, 201, 165, 162, 52],
    [199, 190, 227, 38, 209, 58, 149, 154, 139, 44, 224, 146, 73, 29, 9, 154, 133, 6, 91, 199, 33, 55, 85, 71, 101, 57, 207, 163, 77, 109, 240, 24, 125, 158, 117, 96, 70, 18, 233, 20, 215, 109, 142, 56, 103, 166, 170, 216, 132, 94, 188, 68, 173, 86, 81, 253, 232, 10, 73, 0, 102, 173, 57, 116],
    [250, 139, 200, 197, 44, 160, 43, 59, 188, 183, 143, 143, 26, 68, 125, 204, 43, 129, 207, 99, 181, 40, 187, 41, 206, 19, 171, 104, 162, 167, 130, 219, 12, 171, 37, 202, 148, 81, 253, 137, 155, 47, 110, 226, 46, 39, 138, 133, 51, 165, 192, 58, 191, 123, 6, 203, 221, 221, 57, 122, 86, 56, 238, 199],
    [32, 206, 183, 73, 224, 211, 36, 254, 127, 77, 243, 129, 178, 14, 161, 96, 100, 13, 46, 213, 85, 155, 17, 83, 32, 201, 109, 45, 71, 97, 153, 222, 59, 29, 161, 53, 132, 166, 102, 87, 13, 151, 187, 132, 151, 50, 151, 156, 154, 38, 198, 231, 60, 34, 179, 224, 16, 140, 70, 170, 212, 215, 153, 73],
    [236, 215, 148, 190, 179, 163, 95, 191, 164, 23, 253, 78, 162, 159, 64, 114, 214, 25, 254, 67, 97, 154, 210, 100, 29, 82, 245, 131, 126, 176, 167, 60, 79, 181, 102, 3, 81, 29, 157, 254, 27, 111, 126, 90, 60, 138, 88, 173, 249, 235, 115, 145, 176, 244, 38, 1, 60, 28, 63, 243, 14, 30, 236, 140],
    [196, 7, 186, 81, 211, 155, 217, 160, 193, 69, 34, 92, 154, 49, 15, 249, 124, 174, 116, 3, 140, 208, 63, 191, 238, 187, 212, 185, 16, 56, 146, 24, 223, 113, 187, 71, 197, 27, 116, 70, 116, 192, 53, 65, 231, 50, 166, 192, 80, 128, 178, 29, 117, 91, 11, 210, 174, 23, 18, 6, 208, 81, 111, 4],
    [192, 137, 108, 112, 48, 158, 11, 235, 29, 129, 243, 1, 119, 114, 73, 56, 182, 105, 71, 96, 48, 185, 90, 150, 135, 26, 62, 252, 108, 13, 194, 96, 178, 131, 0, 246, 242, 206, 235, 120, 133, 158, 141, 39, 73, 209, 184, 229, 54, 151, 100, 184, 200, 32, 78, 169, 40, 202, 191, 216, 35, 67, 120, 175],
    [162, 193, 215, 235, 199, 128, 93, 133, 49, 141, 182, 196, 163, 25, 187, 2, 10, 189, 245, 101, 121, 90, 31, 221, 66, 62, 215, 56, 223, 119, 45, 212, 133, 98, 208, 160, 163, 99, 14, 64, 129, 9, 230, 223, 134, 241, 202, 189, 216, 141, 7, 37, 110, 2, 88, 11, 191, 5, 51, 184, 228, 171, 74, 54],
    [221, 25, 194, 173, 154, 39, 173, 59, 159, 236, 166, 25, 14, 143, 35, 215, 103, 230, 116, 33, 180, 198, 177, 223, 55, 164, 120, 49, 227, 20, 47, 132, 144, 116, 10, 228, 61, 199, 187, 194, 217, 109, 227, 181, 134, 105, 215, 44, 139, 24, 51, 174, 161, 3, 214, 35, 221, 248, 157, 162, 252, 54, 158, 137],
    [97, 184, 220, 107, 224, 194, 59, 62, 52, 60, 63, 24, 217, 125, 218, 97, 202, 133, 105, 32, 172, 231, 81, 172, 168, 187, 125, 214, 60, 167, 159, 232, 214, 119, 218, 196, 112, 143, 226, 207, 230, 130, 144, 223, 202, 37, 75, 250, 165, 235, 84, 168, 189, 125, 87, 223, 231, 56, 237, 57, 58, 61, 149, 63],
    [92, 223, 26, 234, 72, 95, 54, 28, 98, 74, 67, 51, 237, 216, 68, 117, 49, 5, 102, 192, 22, 76, 190, 7, 58, 224, 217, 86, 78, 75, 107, 87, 8, 114, 77, 25, 192, 168, 230, 239, 147, 36, 27, 81, 183, 241, 59, 181, 167, 97, 216, 161, 182, 43, 185, 91, 197, 21, 189, 219, 168, 202, 58, 159],
    [80, 151, 195, 149, 69, 202, 197, 37, 72, 254, 84, 16, 192, 54, 164, 40, 99, 152, 185, 194, 177, 181, 41, 181, 26, 191, 195, 45, 158, 195, 213, 109, 211, 146, 101, 115, 57, 239, 105, 6, 117, 234, 244, 18, 142, 28, 12, 168, 142, 177, 207, 25, 98, 164, 10, 115, 80, 142, 7, 67, 83, 48, 201, 126],
    [26, 227, 242, 239, 51, 81, 24, 2, 131, 33, 191, 136, 232, 9, 75, 100, 242, 34, 80, 111, 81, 243, 29, 74, 236, 123, 115, 157, 76, 241, 130, 127, 29, 174, 169, 198, 24, 139, 112, 10, 44, 153, 220, 16, 117, 179, 225, 131, 106, 14, 77, 130, 137, 112, 62, 219, 81, 213, 13, 93, 4, 87, 54, 3],
    [184, 163, 88, 41, 240, 115, 106, 251, 227, 148, 185, 120, 116, 203, 174, 45, 206, 178, 145, 171, 186, 100, 205, 111, 86, 77, 226, 29, 161, 154, 250, 84, 244, 210, 202, 101, 31, 189, 73, 178, 251, 125, 124, 206, 138, 68, 61, 3, 127, 57, 19, 71, 168, 155, 35, 33, 166, 174, 0, 201, 153, 205, 147, 14],
    [93, 176, 239, 239, 208, 33, 56, 141, 93, 230, 68, 153, 237, 13, 250, 18, 109, 248, 59, 60, 91, 27, 115, 152, 137, 200, 103, 43, 95, 144, 161, 39, 139, 60, 61, 106, 10, 124, 198, 62, 20, 95, 202, 43, 243, 91, 112, 201, 72, 106, 149, 200, 200, 55, 109, 199, 150, 72, 200, 220, 7, 36, 36, 109],
    [82, 70, 86, 214, 94, 208, 208, 18, 55, 123, 193, 216, 146, 26, 12, 223, 32, 122, 149, 13, 171, 123, 26, 196, 143, 229, 201, 67, 230, 87, 19, 4, 204, 176, 215, 81, 1, 4, 54, 58, 229, 33, 241, 126, 76, 239, 229, 138, 25, 104, 18, 150, 226, 69, 111, 56, 93, 121, 15, 185, 30, 234, 207, 142],
    [12, 67, 189, 92, 86, 210, 224, 113, 45, 145, 227, 38, 67, 149, 111, 195, 25, 114, 25, 37, 62, 253, 232, 17, 115, 136, 158, 73, 193, 42, 46, 110, 251, 27, 134, 211, 61, 201, 149, 201, 180, 159, 220, 72, 162, 168, 95, 42, 168, 207, 217, 0, 191, 237, 14, 213, 123, 225, 9, 52, 199, 210, 146, 27],
    [75, 108, 71, 168, 96, 220, 161, 0, 212, 52, 95, 18, 58, 215, 94, 55, 63, 128, 10, 249, 104, 35, 45, 11, 225, 115, 14, 215, 19, 107, 15, 205, 33, 78, 101, 235, 70, 196, 70, 140, 73, 91, 229, 25, 236, 158, 136, 105, 165, 195, 52, 19, 227, 251, 223, 252, 38, 166, 169, 38, 198, 91, 51, 5],
    [52, 7, 41, 98, 19, 59, 10, 49, 87, 226, 116, 161, 112, 234, 247, 121, 46, 41, 131, 132, 108, 114, 52, 68, 21, 253, 225, 106, 83, 94, 143, 120, 34, 94, 141, 206, 220, 237, 184, 99, 151, 110, 93, 249, 48, 114, 38, 54, 54, 47, 126, 179, 73, 8, 90, 135, 39, 55, 174, 140, 174, 235, 8, 153],
    [79, 57, 185, 86, 249, 187, 103, 70, 162, 1, 86, 55, 35, 80, 232, 149, 100, 108, 210, 117, 182, 89, 197, 201, 33, 25, 132, 75, 5, 89, 147, 200, 213, 244, 171, 94, 220, 152, 225, 104, 46, 252, 75, 175, 84, 229, 28, 125, 252, 10, 136, 148, 78, 96, 218, 253, 110, 232, 7, 128, 123, 34, 81, 220],
    [242, 113, 232, 129, 125, 21, 118, 181, 15, 213, 112, 149, 204, 13, 245, 153, 208, 192, 223, 252, 238, 83, 64, 253, 166, 72, 191, 48, 127, 7, 61, 209, 214, 245, 181, 39, 111, 117, 166, 160, 7, 153, 184, 15, 201, 140, 206, 93, 184, 129, 91, 16, 86, 193, 58, 73, 206, 208, 53, 98, 233, 254, 111, 41],
    [194, 39, 218, 108, 77, 98, 248, 43, 150, 3, 46, 245, 124, 226, 171, 228, 37, 184, 66, 237, 79, 122, 164, 172, 190, 46, 230, 240, 60, 246, 2, 107, 205, 49, 174, 240, 243, 72, 125, 17, 132, 249, 3, 198, 36, 125, 19, 68, 3, 34, 111, 95, 143, 37, 51, 233, 230, 116, 223, 154, 70, 101, 148, 234],
    [59, 221, 142, 2, 17, 217, 34, 213, 15, 216, 90, 143, 239, 187, 153, 57, 108, 199, 10, 62, 4, 31, 8, 81, 158, 158, 163, 237, 177, 239, 56, 142, 161, 164, 107, 211, 166, 173, 73, 80, 129, 80, 123, 105, 196, 198, 118, 163, 200, 209, 123, 226, 201, 167, 31, 148, 36, 131, 65, 244, 189, 209, 74, 203],
    [195, 161, 80, 175, 80, 116, 68, 91, 152, 115, 11, 87, 128, 198, 48, 140, 133, 162, 218, 77, 57, 89, 207, 155, 84, 18, 252, 110, 89, 36, 237, 125, 245, 195, 94, 177, 247, 149, 68, 58, 165, 151, 168, 224, 196, 254, 6, 176, 171, 38, 88, 254, 20, 248, 7, 40, 13, 71, 99, 85, 45, 79, 6, 10],
    [63, 64, 81, 188, 153, 105, 200, 231, 55, 78, 232, 38, 118, 5, 4, 137, 245, 195, 15, 134, 204, 175, 23, 24, 42, 232, 63, 201, 233, 106, 109, 221, 251, 138, 225, 193, 73, 234, 28, 187, 6, 217, 214, 120, 66, 1, 13, 27, 91, 200, 2, 215, 159, 88, 10, 117, 192, 33, 109, 3, 149, 246, 110, 48],
    [217, 6, 212, 136, 161, 175, 165, 190, 251, 181, 77, 85, 83, 205, 42, 120, 13, 230, 22, 201, 25, 110, 209, 30, 188, 169, 41, 146, 33, 9, 197, 163, 75, 195, 102, 54, 219, 76, 169, 220, 226, 10, 248, 222, 45, 74, 53, 91, 81, 134, 209, 51, 13, 36, 242, 188, 78, 12, 238, 21, 239, 166, 193, 234]]
, dtype=np.uint8)

def dhash(img: _Image|np.ndarray, resize=(32, 18)) -> np.ndarray:
    """_summary_

    Args:
        img (_Image | np.ndarray): RGB pillow Image or (H, W, 3) numpy array
        resize (tuple, optional): dhash resolution. Defaults to (32, 18).

    Returns:
        np.ndarray: hash bits array
    """
    
    if isinstance(img, np.ndarray):
        if resize is None:
            pixels = img.dot([0.2989, 0.5870, 0.1140]).astype(np.uint8)
        else:
            img = Image.fromarray(img)
            
    if isinstance(img, Image.Image):
        if resize is not None:
            img = img.resize(resize)
        pixels = np.array(img.convert('L')) 
        
    H, W = pixels.shape
    pixels = pixels + mask[:H, :W]
    diff_h = pixels[:, 1:] > pixels[:, :-1]
    diff_v = pixels[1:, :] > pixels[:-1, :]

    hash_bits = np.concatenate([diff_h.flatten(), diff_v.flatten()]).astype(np.uint8)
    return hash_bits

def dhash_batch(imgs: np.ndarray) -> np.ndarray:
    """
    Args:
        imgs (np.ndarray): (N, H, W, 3) RGB numpy array
    Returns:
        np.ndarray: (N, hash_len) hash bits array
    """
    if len(imgs.shape) == 3:
        imgs = imgs[np.newaxis, :]
    N, H, W, C = imgs.shape
    assert C == 3
    
    pixels = imgs.dot([0.2989, 0.5870, 0.1140]).astype(np.uint8)
    pixels = pixels + mask[:H, :W]
    diff_h = (pixels[:, :, 1:] > pixels[:, :, :-1]).reshape((N, -1))
    diff_v = (pixels[:, 1:, :] > pixels[:, :-1, :]).reshape((N, -1))
    
    hash_bits = np.concatenate([diff_h, diff_v], axis=1).astype(np.uint8)
    return hash_bits
    
def judge_by_dhash(hash1: np.ndarray, hash2: np.ndarray, threshold: int):
    hamming = np.bitwise_xor(hash1, hash2).sum()
    return hamming <= threshold, hamming
